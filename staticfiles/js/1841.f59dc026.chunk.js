"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[1841,6657],{6657:(e,s,a)=>{a.r(s),a.d(s,{default:()=>x});var l=a(2791),n=a(6912),r=a(2937),c=(a(2673),a(9792)),t=a(5294),i=a(2958),d=a(2585),o=a(7689),m=a(184);const x=()=>{const e=new URL(window.location.href.replace("/#","")),[s]=(0,l.useState)(e.searchParams.get("slug")),[a,x]=(0,l.useState)(null),[h,g]=(0,l.useState)(null),{state:u,dispatch:j}=(0,l.useContext)(d.y),{accessToken:b}=u,p=(0,l.useRef)(null),[N,f]=(0,l.useState)(!1),y=(0,l.useRef)(null),v=(0,o.s0)(),[w,_]=(0,c.Z)();(0,l.useEffect)((()=>{if(s){const e={"Content-Type":"application/json","ngrok-skip-browser-warning":!0},a=t.Z.create();_(w,a,"/manage/session/create_lecture_session/","post",e,{lecture_slug:s},null).then((e=>{if(!1===e.error){const s=e.response;y.current||(y.current=new WebSocket("".concat(i.I,"/ws/attendance_session/").concat(s.data.data.session_id,"/?").concat(b))),g(s.data.data.marked_attendances),x(s.data.data)}else alert(e.errorMessage.message),v("/teacher/dashboard")}))}}),[s]),(0,l.useEffect)((()=>{y.current&&(y.current.onopen=()=>{console.log("WebSocket connection established")},y.current.onclose=()=>{console.log("WebSocket connection closed")},y.current.onmessage=e=>{let s=JSON.parse(e.data);console.log(s),s.message&&("attendance_marked"==s.message.action?g((e=>[...e,s.message.data])):"session_ended"==s.message.action?(g(s.message.data.marked_attendances),alert("Session has ended"),f(!0)):"session_already_ended"==s.message.action&&alert("Session has already been ended"))},y.current.onerror=e=>{console.error("WebSocket error:",e)})}),[y.current]);return(0,m.jsx)(m.Fragment,{children:a?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(r.rb,{children:(0,m.jsx)(r.b7,{children:(0,m.jsxs)(r.xH,{className:"card",children:[(0,m.jsx)(r.bn,{children:(0,m.jsxs)("div",{className:"d-flex justify-content-sm-between justify-content-center flex-wrap",children:[(0,m.jsx)("div",{className:"mx-3 mb-2",children:(0,m.jsx)("strong",{children:"Lecture Details"})}),(0,m.jsx)("div",{className:"mx-3",children:(0,m.jsx)("strong",{children:new Date(a.created_at).toLocaleString()})})]})}),(0,m.jsx)(r.sl,{children:(0,m.jsx)("div",{className:"d-flex flex-wrap w-100",children:(0,m.jsx)("div",{className:"col-12",children:(0,m.jsxs)("div",{className:"w-100 d-flex flex-wrap flex-1 justify-center",children:[(0,m.jsx)("div",{className:"text-center col-12 col-sm-3 col-md-3 col-lg-3",children:(0,m.jsxs)("p",{style:{margin:"0px",padding:"0px"},children:[a.lecture.start_time," | ",a.lecture.end_time]})}),(0,m.jsx)("div",{className:"text-center col-12 col-sm-3 col-md-3 col-lg-3",children:(0,m.jsx)("p",{style:{margin:"0px",padding:"0px"},children:a.lecture.subject.subject_name})}),(0,m.jsx)("div",{className:"text-center col-12 col-sm-3 col-md-3 col-lg-3",children:(0,m.jsx)("p",{style:{margin:"0px",padding:"0px"},children:a.lecture.type})}),(0,m.jsx)("div",{className:"text-center col-12 col-sm-3 col-md-3 col-lg-3",children:(0,m.jsx)("p",{style:{margin:"0px",padding:"0px"},children:a.lecture.classroom.class_name})})]})})})})]})})}),(0,m.jsx)(r.rb,{className:"mt-3",children:(0,m.jsx)(r.b7,{xs:!0,children:(0,m.jsxs)(r.xH,{className:"mb-4",children:[(0,m.jsx)(r.bn,{className:"",children:N?(0,m.jsx)(n.DownloadTableExcel,{filename:"".concat(a.lecture.subject.subject_name," - ").concat(new Date(a.lecture.session.day).toLocaleString()),sheet:"users",currentTableRef:p.current,children:(0,m.jsx)("button",{className:"my-2 w-100 btn btn btn-outline-primary",children:" Export excel "})}):(0,m.jsxs)("div",{className:"my-2 w-100 btn btn btn-outline-danger",onClick:()=>{y.current&&y.current.send(JSON.stringify({action:"end_session"}))},children:[(0,m.jsx)("span",{className:"me-3 d-inline",children:"End Session"}),(0,m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"d-inline bi bi-stop-circle-fill",viewBox:"0 0 16 16",children:(0,m.jsx)("path",{d:"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M6.5 5A1.5 1.5 0 0 0 5 6.5v3A1.5 1.5 0 0 0 6.5 11h3A1.5 1.5 0 0 0 11 9.5v-3A1.5 1.5 0 0 0 9.5 5z"})})]})}),(0,m.jsx)(r.sl,{children:(0,m.jsx)(r.rb,{className:"w-100 flex-col",children:(0,m.jsx)(r.b7,{className:"col-12",children:(0,m.jsx)("div",{className:"table-responsive",children:(0,m.jsxs)("table",{align:"middle",className:"table align-middle table-hover text-center mb-0 border hover responsive",ref:p,children:[(0,m.jsxs)(r.V,{color:"light",children:[(0,m.jsx)(r.T6,{"aria-colspan":5,children:(0,m.jsx)(r.is,{colSpan:5,children:"L.D COLLEGE OF ENGINEERING"})}),(0,m.jsx)(r.T6,{"aria-colspan":5,children:(0,m.jsxs)(r.is,{colSpan:5,children:["Subject: ",a.lecture.subject.subject_name," | DATE: ",a.lecture.session.day]})}),(0,m.jsxs)(r.T6,{children:[(0,m.jsx)(r.is,{children:"Enrollment No"}),(0,m.jsx)(r.is,{children:"Student Name"}),(0,m.jsx)(r.is,{children:"IP Addr"}),(0,m.jsx)(r.is,{children:"Batch"}),(0,m.jsx)(r.is,{children:"Status"})]})]}),(0,m.jsx)(r.NR,{children:h&&h.map(((e,s)=>(0,m.jsxs)(r.T6,{"v-for":"alert alert-primary item in tableItems",children:[(0,m.jsx)(r.NN,{children:(0,m.jsx)("div",{children:e.student.enrollment?e.student.enrollment:"-"})}),(0,m.jsx)(r.NN,{children:(0,m.jsx)("div",{children:e.student.profile.name?e.student.profile.name:"-"})}),(0,m.jsx)(r.NN,{children:(0,m.jsx)("div",{children:e.marking_ip?e.marking_ip:"-"})}),(0,m.jsx)(r.NN,{children:(0,m.jsx)("div",{children:e.batches?e.batches.map(((e,s)=>(0,m.jsx)("span",{children:e.batch_name.toUpperCase()},s))):"-"})}),e.is_present?(0,m.jsx)(r.NN,{children:(0,m.jsxs)("div",{className:"text-success d-flex align-items-center justify-content-center",children:[(0,m.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"mx-auto bi bi-patch-check",viewBox:"0 0 16 16",children:[(0,m.jsx)("path",{fillRule:"evenodd",d:"M10.354 6.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7 8.793l2.646-2.647a.5.5 0 0 1 .708 0"}),(0,m.jsx)("path",{d:"m10.273 2.513-.921-.944.715-.698.622.637.89-.011a2.89 2.89 0 0 1 2.924 2.924l-.01.89.636.622a2.89 2.89 0 0 1 0 4.134l-.637.622.011.89a2.89 2.89 0 0 1-2.924 2.924l-.89-.01-.622.636a2.89 2.89 0 0 1-4.134 0l-.622-.637-.89.011a2.89 2.89 0 0 1-2.924-2.924l.01-.89-.636-.622a2.89 2.89 0 0 1 0-4.134l.637-.622-.011-.89a2.89 2.89 0 0 1 2.924-2.924l.89.01.622-.636a2.89 2.89 0 0 1 4.134 0l-.715.698a1.89 1.89 0 0 0-2.704 0l-.92.944-1.32-.016a1.89 1.89 0 0 0-1.911 1.912l.016 1.318-.944.921a1.89 1.89 0 0 0 0 2.704l.944.92-.016 1.32a1.89 1.89 0 0 0 1.912 1.911l1.318-.016.921.944a1.89 1.89 0 0 0 2.704 0l.92-.944 1.32.016a1.89 1.89 0 0 0 1.911-1.912l-.016-1.318.944-.921a1.89 1.89 0 0 0 0-2.704l-.944-.92.016-1.32a1.89 1.89 0 0 0-1.912-1.911z"})]}),(0,m.jsx)("p",{style:{visibility:"hidden"},children:"P"})]})}):(0,m.jsx)(r.NN,{children:(0,m.jsxs)("div",{className:"text-danger d-flex align-items-center justify-content-center",children:[(0,m.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-x-octagon",viewBox:"0 0 16 16",children:[(0,m.jsx)("path",{d:"M4.54.146A.5.5 0 0 1 4.893 0h6.214a.5.5 0 0 1 .353.146l4.394 4.394a.5.5 0 0 1 .146.353v6.214a.5.5 0 0 1-.146.353l-4.394 4.394a.5.5 0 0 1-.353.146H4.893a.5.5 0 0 1-.353-.146L.146 11.46A.5.5 0 0 1 0 11.107V4.893a.5.5 0 0 1 .146-.353zM5.1 1 1 5.1v5.8L5.1 15h5.8l4.1-4.1V5.1L10.9 1z"}),(0,m.jsx)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"})]}),(0,m.jsx)("p",{style:{visibility:"hidden"},children:"F"})]})})]},s)))})]})})})})})]})})})]}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{role:"status",className:"p-4 border border-gray-200 rounded shadow animate-pulse md:p-6 dark:border-gray-700",children:[(0,m.jsx)("div",{className:"h-2.5 bg-gray-200 rounded-full dark:bg-gray-700 w-32 mb-2.5"}),(0,m.jsx)("div",{className:"w-48 h-2 mb-10 bg-gray-200 rounded-full dark:bg-gray-700"}),(0,m.jsxs)("div",{className:"flex items-baseline mt-4",children:[(0,m.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-72 dark:bg-gray-300"}),(0,m.jsx)("div",{className:"w-full h-56 ms-6 bg-gray-200 rounded-t-lg dark:bg-gray-300"}),(0,m.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-72 ms-6 dark:bg-gray-300"}),(0,m.jsx)("div",{className:"w-full h-64 ms-6 bg-gray-200 rounded-t-lg dark:bg-gray-300"}),(0,m.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-80 ms-6 dark:bg-gray-300"}),(0,m.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-72 ms-6 dark:bg-gray-300"}),(0,m.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-80 ms-6 dark:bg-gray-300"})]}),(0,m.jsx)("span",{className:"sr-only",children:"Loading..."})]}),(0,m.jsxs)("div",{role:"status",className:"p-4 border border-gray-200 rounded shadow animate-pulse md:p-6 dark:border-gray-700",children:[(0,m.jsx)("div",{className:"h-2.5 bg-gray-200 rounded-full dark:bg-gray-700 w-32 mb-2.5"}),(0,m.jsx)("div",{className:"w-48 h-2 mb-10 bg-gray-200 rounded-full dark:bg-gray-700"}),(0,m.jsxs)("div",{className:"flex items-baseline mt-4",children:[(0,m.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-72 dark:bg-gray-300"}),(0,m.jsx)("div",{className:"w-full h-56 ms-6 bg-gray-200 rounded-t-lg dark:bg-gray-300"}),(0,m.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-72 ms-6 dark:bg-gray-300"}),(0,m.jsx)("div",{className:"w-full h-64 ms-6 bg-gray-200 rounded-t-lg dark:bg-gray-300"}),(0,m.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-80 ms-6 dark:bg-gray-300"}),(0,m.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-72 ms-6 dark:bg-gray-300"}),(0,m.jsx)("div",{className:"w-full bg-gray-200 rounded-t-lg h-80 ms-6 dark:bg-gray-300"})]}),(0,m.jsx)("span",{className:"sr-only",children:"Loading..."})]})]})})}},1841:(e,s,a)=>{a.r(s),a.d(s,{default:()=>m});var l=a(2791),n=a(2937),r=a(5294),c=a(9792),t=(a(7934),a(6657),a(7689)),i=a(2426),d=a.n(i),o=a(184);function m(){const[e,s]=(0,l.useState)(!1),[a,i]=(0,l.useState)(null),m=(0,t.s0)(),[x,h]=(0,c.Z)(),[g,u]=(0,l.useState)(null),j=async e=>{m("/teacher/session?slug=".concat(e))};return(0,l.useEffect)((()=>{(async()=>{const e=r.Z.create(),s=await h(x,e,"/manage/get_timetable_for_teacher","get",{"Content-Type":"application/json","ngrok-skip-browser-warning":!0},null,null);if(!1===s.error){const e=s.response;u(e.data.data)}else alert(s.errorMessage.message)})()}),[]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(n.rb,{className:"mb-3",children:(0,o.jsx)(n.b7,{children:g?g.map(((e,s)=>(0,o.jsx)(n.rb,{className:"text-center mb-5 justify-content-center",children:(0,o.jsx)(n.b7,{className:"col-lg-12 col-md-12 col-sm-12 col-xs-12",children:(0,o.jsxs)(n.xH,{className:"",children:[(0,o.jsxs)(n.bn,{className:"d-flex justify-content-center justify-content-sm-between flex-wrap",children:[(0,o.jsxs)("span",{children:["Semester - ",e.division.semester.no]}),(0,o.jsxs)("span",{children:["Division - ",e.division.division_name]})]}),(0,o.jsx)(n.sl,{children:(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(n.rb,{className:"text-center justify-content-center",children:(0,o.jsx)(n.b7,{className:"col-lg-12 col-md-12 col-sm-12 col-xs-12",children:(0,o.jsx)("div",{className:"",children:(0,o.jsx)("div",{children:(0,o.jsx)(n.rb,{className:"flex-column",style:{padding:"0"},children:e?e.schedules.map(((e,s)=>(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(n.b7,{className:"d-flex align-items-center flex-column",children:[(0,o.jsx)(n.Gc,{className:"m-0 rounded-0 w-100 p-2 d-flex justify-content-between align-items-center",color:"primary",visible:!0,children:e.day.toUpperCase()}),(0,o.jsx)("div",{className:"w-100  rounded-0 border-0",children:(0,o.jsx)("div",{className:"",style:{paddingBottom:"0px"},children:(0,o.jsx)("div",{className:"justify-content-center w-100",children:e.lectures.length>0?e.lectures.map(((e,s)=>(0,o.jsxs)(n.oo,{autohide:!1,visible:!0,className:"mt-2 w-100",children:[(0,o.jsxs)(n.xZ,{className:"d-flex flex-wrap justify-content-sm-between justify-content-center",children:[(0,o.jsx)("div",{className:"fw-bold mx-2 my-2",children:e.subject.subject_name.charAt(0).toUpperCase()+e.subject.subject_name.slice(1)}),(0,o.jsx)("small",{className:"mx-2 my-2",children:e.type.toUpperCase()}),(0,o.jsxs)("small",{className:"mx-2 my-2",children:[d()(e.start_time.slice(0,5),"HH:mm").format("h:mm A")," |"," ",d()(e.end_time.slice(0,5),"HH:mm").format("h:mm A")]})]}),(0,o.jsxs)(n.S3,{className:"d-flex flex-row flex-wrap justify-content-center",children:[(0,o.jsxs)(n.rb,{className:"w-100 align-items-center",children:[(0,o.jsxs)(n.b7,{className:"text-sm-start col-12 col-sm-4 col-lg-4 col-md-4",children:["Prof - ",e.teacher.charAt(0).toUpperCase()+e.teacher.slice(1)," "]}),(0,o.jsx)(n.b7,{className:" text-sm-end col-12 col-sm-4 col-lg-4 col-md-4",children:(0,o.jsxs)("div",{className:"w-100 text-center",children:[" ",e.batches.map(((s,a)=>(0,o.jsxs)("span",{children:[s.batch_name.toUpperCase(),a<e.batches.length-1&&", "]},a)))," "]})}),(0,o.jsxs)(n.b7,{className:"text-sm-end col-12 col-sm-4 col-lg-4 col-md-4",children:[e.classroom.class_name.charAt(0).toUpperCase()+e.classroom.class_name.slice(1)," "]})]}),(0,o.jsx)("hr",{className:"w-100"}),(0,o.jsx)("div",{className:"d-flex w-100",children:(0,o.jsxs)("div",{className:"w-100",children:["pre"===e.session.active&&(0,o.jsx)("button",{className:"btn btn-outline-primary w-100 mt-3",value:e.slug,onClick:e=>j(e.target.value),children:"Start Session"}),"ongoing"===e.session.active&&(0,o.jsx)("button",{className:"btn btn-outline-primary w-100 mt-3",value:e.slug,onClick:e=>j(e.target.value),children:"Ongoing Session"}),"post"===e.session.active&&(0,o.jsx)("button",{disabled:!0,className:"btn btn-outline-secondary w-100 mt-3",value:e.slug,onClick:e=>j(e.target.value),children:"Session Ended"})]})}),(0,o.jsx)("div",{children:(0,o.jsx)("hr",{})})]})]},s))):(0,o.jsx)(n.oo,{autohide:!1,visible:!0,className:"w-100 my-3",children:(0,o.jsx)(n.S3,{children:"You don't have any lectures today ://"})})})})})]},s)}))):(0,o.jsx)(n.oo,{autohide:!1,visible:!0,children:(0,o.jsx)(n.S3,{children:"No Schedules Found"})})})})})})})})})]})})},s))):(0,o.jsx)(n.oo,{animation:!1,autohide:!1,visible:!0,className:"mx-auto w-100",children:(0,o.jsx)(n.xZ,{className:"bg-dark d-flex justify-content-center",children:(0,o.jsx)("img",{src:"/static/media/smartroll_logo.a3c3e21d0b4a56919e74.png",width:100,alt:"SmartRoll Logo"})})})})})})}}}]);
//# sourceMappingURL=1841.f59dc026.chunk.js.map