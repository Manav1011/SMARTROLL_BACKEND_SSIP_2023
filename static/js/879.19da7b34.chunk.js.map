{"version":3,"file":"static/js/879.19da7b34.chunk.js","mappings":"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","sources":["views/teacher/Sessionmanage.js"],"sourcesContent":["import React, { useState, useRef, useEffect, useContext } from 'react'\nimport { DownloadTableExcel } from 'react-export-table-to-excel'\nimport moment from 'moment'\nimport {\n  COffcanvas,\n  COffcanvasBody,\n  CAlert,\n  CRow,\n  CCol,\n  CCard,\n  CCardHeader,\n  CCardBody,\n  CTable,\n  CTableBody,\n  CTableDataCell,\n  CTableHead,\n  CTableHeaderCell,\n  CTableRow,\n} from '@coreui/react'\nimport '../../css/tailwind.css'\nimport useAPI from 'src/global_function/useApi'\nimport axios from 'axios'\nimport { websocket } from 'src/base_url'\nimport { Store } from '../forms/validation/store'\nimport { useNavigate } from 'react-router-dom'\n\nconst Sessionmanage = () => {\n  const url = new URL(window.location.href.replace('/#', ''))\n  const [lectureSlug] = useState(url.searchParams.get('slug'))\n  const [session_data, setSessionData] = useState(null)\n  const [attendances, setAttendances] = useState(null)\n  const { state, dispatch: ctxDispatch } = useContext(Store)\n  const { accessToken } = state\n  const tableRef = useRef(null)\n  const [sessionEnded, setSessionEnded] = useState(false)\n  const ws = useRef(null)\n  const navigate = useNavigate()\n  const [StoredTokens, CallAPI] = useAPI()\n\n  useEffect(() => {\n    if (navigator.geolocation) {\n      function successCallback(position) {\n        // console.log('Latitude:', position.coords.latitude);\n        // console.log('Longitude:', position.coords.longitude);\n      }\n      function errorCallback(error) {\n        console.error('Error getting location:', error.message)\n      }\n      for (let i = 0; i < 5; i++) {\n        navigator.geolocation.getCurrentPosition(successCallback, errorCallback, {\n          enableHighAccuracy: true,\n          maximumAge: 0,\n        })\n      }\n    } else {\n      console.error('Geolocation is not supported by this browser.')\n    }\n    if (lectureSlug) {\n      const headers = {\n        'Content-Type': 'application/json',\n        'ngrok-skip-browser-warning': true,\n      }\n\n      const axiosInstance = axios.create()\n      CallAPI(\n        StoredTokens,\n        axiosInstance,\n        '/manage/session/create_lecture_session/',\n        'post',\n        headers,\n        { lecture_slug: lectureSlug },\n        null,\n      ).then((responseobj) => {\n        if (responseobj.error === false) {\n          const response = responseobj.response\n          if (response.data.data.active == 'post') {\n            alert('The session has already been ended!!')\n            navigate('/teacher/dashboard')\n          }\n          if (!ws.current) {\n            ws.current = new WebSocket(\n              `${websocket}/ws/attendance_session/${response.data.data.session_id}/?${accessToken}`,\n            )\n          }\n          setAttendances(response.data.data.marked_attendances)\n          setSessionData(response.data.data)\n        } else {\n          alert(responseobj.errorMessage.message)\n          navigate('/teacher/dashboard')\n        }\n      })\n    }\n  }, [lectureSlug])\n\n  useEffect(() => {\n    if (ws.current) {\n      ws.current.onopen = () => {\n        // console.log('WebSocket connection established')\n      }\n\n      ws.current.onclose = () => {\n        // console.log('WebSocket connection closed')\n      }\n\n      ws.current.onmessage = (event) => {\n        let data = JSON.parse(event.data)\n        // console.log(data)\n        if (data.message) {\n          if (data.message.action == 'attendance_marked') {\n            setAttendances((prevArray) => [...prevArray, data.message.data])\n          } else if (data.message.action == 'session_ended') {\n            setAttendances(data.message.data.marked_attendances)\n            alert('Session has ended')\n            setSessionEnded(true)\n            // navigate(\"/teacherdashboard\")\n          } else if (data.message.action == 'session_already_ended') {\n            // setSessionEnded(true)\n            alert('Session has already been ended')\n          }\n        }\n        // Handle received message\n      }\n\n      ws.current.onerror = (error) => {\n        console.error('WebSocket error:', error)\n      }\n    }\n  }, [ws.current])\n\n  const stopAttendance = () => {\n    if (ws.current) {\n      ws.current.send(\n        JSON.stringify({\n          action: 'end_session',\n        }),\n      )\n    }\n  }\n\n  const mark_student_attendance = async (event, attendance_Slug) => {\n    event.preventDefault()\n    try {\n      /* eslint-disable no-restricted-globals */\n\n      if (!confirm('Are you sure you want to mark the attendance manually?')) return\n      // console.log(attendance_Slug)\n      event.target.checked = 'checked'\n      event.target.disabled = true\n      const axiosInstance = axios.create()\n      const headers = {\n        'Content-Type': 'application/json',\n        'ngrok-skip-browser-warning': true,\n      }\n      const body = {\n        attendance_slug: attendance_Slug,\n      }\n      const response_obj = await CallAPI(\n        StoredTokens,\n        axiosInstance,\n        `/manage/session/mark_attendance_for_absent_student/`,\n        'post',\n        headers,\n        body,\n        null,\n      )\n      if (response_obj.error === false) {\n        const response = response_obj.response\n        const div_element = event.target.parentElement\n        const children = div_element.children\n        children[1].innerText = 'P'\n        div_element.removeChild(children[0])\n        var svgElement = document.createElementNS('http://www.w3.org/2000/svg', 'svg')\n        svgElement.setAttribute('xmlns', 'http://www.w3.org/2000/svg')\n        svgElement.setAttribute('width', '16')\n        svgElement.setAttribute('height', '16')\n        svgElement.setAttribute('fill', 'currentColor')\n        svgElement.setAttribute('class', 'mx-auto bi bi-patch-check')\n        svgElement.setAttribute('viewBox', '0 0 16 16')\n\n        var path1 = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n        path1.setAttribute('fill-rule', 'evenodd')\n        path1.setAttribute(\n          'd',\n          'M10.354 6.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7 8.793l2.646-2.647a.5.5 0 0 1 .708 0',\n        )\n\n        var path2 = document.createElementNS('http://www.w3.org/2000/svg', 'path')\n        path2.setAttribute(\n          'd',\n          'm10.273 2.513-.921-.944.715-.698.622.637.89-.011a2.89 2.89 0 0 1 2.924 2.924l-.01.89.636.622a2.89 2.89 0 0 1 0 4.134l-.637.622.011.89a2.89 2.89 0 0 1-2.924 2.924l-.89-.01-.622.636a2.89 2.89 0 0 1-4.134 0l-.622-.637-.89.011a2.89 2.89 0 0 1-2.924-2.924l.01-.89-.636-.622a2.89 2.89 0 0 1 0-4.134l.637-.622-.011-.89a2.89 2.89 0 0 1 2.924-2.924l.89.01.622-.636a2.89 2.89 0 0 1 4.134 0l-.715.698a1.89 1.89 0 0 0-2.704 0l-.92.944-1.32-.016a1.89 1.89 0 0 0-1.911 1.912l.016 1.318-.944.921a1.89 1.89 0 0 0 0 2.704l.944.92-.016 1.32a1.89 1.89 0 0 0 1.912 1.911l1.318-.016.921.944a1.89 1.89 0 0 0 2.704 0l.92-.944 1.32.016a1.89 1.89 0 0 0 1.911-1.912l-.016-1.318.944-.921a1.89 1.89 0 0 0 0-2.704l-.944-.92.016-1.32a1.89 1.89 0 0 0-1.912-1.911z',\n        )\n\n        svgElement.appendChild(path1)\n        svgElement.appendChild(path2)\n        div_element.prepend(svgElement)\n      } else {\n        alert(response_obj.errorMessage.message)\n      }\n    } catch (error) {\n      alert(error.message)\n    }\n  }\n\n  return (\n    <>\n      {session_data ? (\n        <>\n          <CRow>\n            <CCol>\n              <CCard className=\"card\">\n                <CCardHeader>\n                  <div className=\"d-flex justify-content-sm-between justify-content-center flex-wrap\">\n                    <div className=\"mx-3 mb-2\">\n                      <strong>Lecture Details</strong>\n                    </div>\n                    <div className=\"mx-3\">\n                      <strong>{new Date(session_data.created_at).toLocaleString()}</strong>\n                    </div>\n                  </div>\n                </CCardHeader>\n                <CCardBody>\n                  <div className=\"d-flex flex-wrap w-100\">\n                    <div className=\"col-12\">\n                      <div className=\"w-100 d-flex flex-wrap flex-1 justify-center\">\n                        <div className=\"text-center col-12 col-sm-3 col-md-3 col-lg-3\">\n                          <p style={{ margin: '0px', padding: '0px' }}>\n                            {session_data.lecture.start_time} | {session_data.lecture.end_time}\n                          </p>\n                        </div>\n                        <div className=\"text-center col-12 col-sm-3 col-md-3 col-lg-3\">\n                          <p style={{ margin: '0px', padding: '0px' }}>\n                            {session_data.lecture.subject.subject_name}\n                          </p>\n                        </div>\n                        <div className=\"text-center col-12 col-sm-3 col-md-3 col-lg-3\">\n                          <p style={{ margin: '0px', padding: '0px' }}>\n                            {session_data.lecture.type}\n                          </p>\n                        </div>\n                        <div className=\"text-center col-12 col-sm-3 col-md-3 col-lg-3\">\n                          <p style={{ margin: '0px', padding: '0px' }}>\n                            {session_data.lecture.classroom.class_name}\n                          </p>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </CCardBody>\n              </CCard>\n            </CCol>\n          </CRow>\n          <CRow className=\"mt-3\">\n            <CCol xs>\n              <CCard className=\"mb-4\">\n                <CCardHeader className=\"\">\n                  {!sessionEnded ? (\n                    <div\n                      className=\"my-2 w-100 btn btn btn-outline-danger\"\n                      onClick={() => {\n                        stopAttendance()\n                      }}\n                    >\n                      <span className=\"me-3 d-inline\">End Session</span>\n                      <svg\n                        xmlns=\"http://www.w3.org/2000/svg\"\n                        width=\"16\"\n                        height=\"16\"\n                        fill=\"currentColor\"\n                        className=\"d-inline bi bi-stop-circle-fill\"\n                        viewBox=\"0 0 16 16\"\n                      >\n                        <path d=\"M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M6.5 5A1.5 1.5 0 0 0 5 6.5v3A1.5 1.5 0 0 0 6.5 11h3A1.5 1.5 0 0 0 11 9.5v-3A1.5 1.5 0 0 0 9.5 5z\" />\n                      </svg>\n                    </div>\n                  ) : (\n                    <DownloadTableExcel\n                      filename={`${session_data.lecture.subject.subject_name} - ${new Date(\n                        session_data.lecture.session.day,\n                      ).toLocaleString()}`}\n                      sheet=\"users\"\n                      currentTableRef={tableRef.current}\n                    >\n                      <button className=\"my-2 w-100 btn btn btn-outline-primary\">\n                        {' '}\n                        Export excel{' '}\n                      </button>\n                    </DownloadTableExcel>\n                  )}\n                </CCardHeader>\n                <CCardBody>\n                  <CRow className=\"w-100 flex-col\">\n                    <CCol className=\"col-12\">\n                      <div className=\"table-responsive\">\n                        <table\n                          align=\"middle\"\n                          className=\"table align-middle table-hover text-center mb-0 border hover responsive\"\n                          ref={tableRef}\n                        >\n                          <CTableHead color=\"light\">\n                            <CTableRow aria-colspan={5}>\n                              <CTableHeaderCell colSpan={5}>\n                                L.D COLLEGE OF ENGINEERING\n                              </CTableHeaderCell>\n                            </CTableRow>\n                            <CTableRow aria-colspan={5}>\n                              <CTableHeaderCell colSpan={5}>\n                                Subject: {session_data.lecture.subject.subject_name} | DATE:{' '}\n                                {session_data.lecture.session.day} | TIME:{' '}\n                                {moment(\n                                  session_data.lecture.start_time.slice(0, 5),\n                                  'HH:mm',\n                                ).format('h:mm A')}{' '}\n                                to{' '}\n                                {moment(session_data.lecture.end_time.slice(0, 5), 'HH:mm').format(\n                                  'h:mm A',\n                                )}\n                              </CTableHeaderCell>\n                            </CTableRow>\n                            <CTableRow>\n                              {/* <CTableHeaderCell>SR. NO</CTableHeaderCell> */}\n                              <CTableHeaderCell>Enrollment No</CTableHeaderCell>\n                              <CTableHeaderCell>Student Name</CTableHeaderCell>\n                              {/* <CTableHeaderCell>IP Addr</CTableHeaderCell> */}\n                              <CTableHeaderCell>Batch</CTableHeaderCell>\n                              <CTableHeaderCell>Status</CTableHeaderCell>\n                            </CTableRow>\n                          </CTableHead>\n                          <CTableBody>\n                            {attendances &&\n                              attendances.map((item, index) => (\n                                <CTableRow\n                                  v-for=\"alert alert-primary item in tableItems\"\n                                  key={index}\n                                >\n                                  {/* <CTableDataCell>\n                                        <div>{item.student.sr_no}</div>   \n                                </CTableDataCell> */}\n                                  <CTableDataCell>\n                                    <div>\n                                      {item.student.enrollment ? item.student.enrollment : '-'}\n                                    </div>\n                                  </CTableDataCell>\n                                  <CTableDataCell>\n                                    <div>\n                                      {item.student.profile.name ? item.student.profile.name : '-'}\n                                    </div>\n                                  </CTableDataCell>\n                                  {/* <CTableDataCell>\n                                  <div>{item.marking_ip ? item.marking_ip : '-'}</div>\n                                </CTableDataCell> */}\n                                  <CTableDataCell>\n                                    <div>\n                                      {item.batches\n                                        ? item.batches.map((batch, index) => (\n                                            <span key={index}>\n                                              {batch.batch_name.toUpperCase()}\n                                            </span>\n                                          ))\n                                        : '-'}\n                                    </div>\n                                  </CTableDataCell>\n                                  {item.is_present ? (\n                                    <CTableDataCell>\n                                      <div className=\"text-success d-flex justify-content-center align-items-center\">\n                                        <svg\n                                          xmlns=\"http://www.w3.org/2000/svg\"\n                                          width=\"16\"\n                                          height=\"16\"\n                                          fill=\"currentColor\"\n                                          className=\"mx-auto bi bi-patch-check\"\n                                          viewBox=\"0 0 16 16\"\n                                        >\n                                          <path\n                                            fillRule=\"evenodd\"\n                                            d=\"M10.354 6.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7 8.793l2.646-2.647a.5.5 0 0 1 .708 0\"\n                                          />\n                                          <path d=\"m10.273 2.513-.921-.944.715-.698.622.637.89-.011a2.89 2.89 0 0 1 2.924 2.924l-.01.89.636.622a2.89 2.89 0 0 1 0 4.134l-.637.622.011.89a2.89 2.89 0 0 1-2.924 2.924l-.89-.01-.622.636a2.89 2.89 0 0 1-4.134 0l-.622-.637-.89.011a2.89 2.89 0 0 1-2.924-2.924l.01-.89-.636-.622a2.89 2.89 0 0 1 0-4.134l.637-.622-.011-.89a2.89 2.89 0 0 1 2.924-2.924l.89.01.622-.636a2.89 2.89 0 0 1 4.134 0l-.715.698a1.89 1.89 0 0 0-2.704 0l-.92.944-1.32-.016a1.89 1.89 0 0 0-1.911 1.912l.016 1.318-.944.921a1.89 1.89 0 0 0 0 2.704l.944.92-.016 1.32a1.89 1.89 0 0 0 1.912 1.911l1.318-.016.921.944a1.89 1.89 0 0 0 2.704 0l.92-.944 1.32.016a1.89 1.89 0 0 0 1.911-1.912l-.016-1.318.944-.921a1.89 1.89 0 0 0 0-2.704l-.944-.92.016-1.32a1.89 1.89 0 0 0-1.912-1.911z\" />\n                                        </svg>\n                                        <p style={{ visibility: 'hidden' }}>P</p>\n                                      </div>\n                                    </CTableDataCell>\n                                  ) : (\n                                    <CTableDataCell>\n                                      <div className=\"text-success d-flex justify-content-center align-items-center\">\n                                        <input\n                                          type=\"checkbox\"\n                                          onClick={(e) => {\n                                            mark_student_attendance(e, item.slug)\n                                          }}\n                                        ></input>\n                                        <p style={{ visibility: 'hidden' }}>A</p>\n                                      </div>\n                                    </CTableDataCell>\n                                  )}\n                                </CTableRow>\n                              ))}\n                          </CTableBody>\n                        </table>\n                      </div>\n                    </CCol>\n                  </CRow>\n                </CCardBody>\n              </CCard>\n            </CCol>\n          </CRow>\n        </>\n      ) : (\n        <>\n          <div\n            role=\"status\"\n            className=\"p-4 border border-gray-200 rounded shadow animate-pulse md:p-6 dark:border-gray-700\"\n          >\n            <div className=\"h-2.5 bg-gray-200 rounded-full dark:bg-gray-700 w-32 mb-2.5\"></div>\n            <div className=\"w-48 h-2 mb-10 bg-gray-200 rounded-full dark:bg-gray-700\"></div>\n            <div className=\"flex items-baseline mt-4\">\n              <div className=\"w-full bg-gray-200 rounded-t-lg h-72 dark:bg-gray-300\"></div>\n              <div className=\"w-full h-56 ms-6 bg-gray-200 rounded-t-lg dark:bg-gray-300\"></div>\n              <div className=\"w-full bg-gray-200 rounded-t-lg h-72 ms-6 dark:bg-gray-300\"></div>\n              <div className=\"w-full h-64 ms-6 bg-gray-200 rounded-t-lg dark:bg-gray-300\"></div>\n              <div className=\"w-full bg-gray-200 rounded-t-lg h-80 ms-6 dark:bg-gray-300\"></div>\n              <div className=\"w-full bg-gray-200 rounded-t-lg h-72 ms-6 dark:bg-gray-300\"></div>\n              <div className=\"w-full bg-gray-200 rounded-t-lg h-80 ms-6 dark:bg-gray-300\"></div>\n            </div>\n            <span className=\"sr-only\">Loading...</span>\n          </div>\n          <div\n            role=\"status\"\n            className=\"p-4 border border-gray-200 rounded shadow animate-pulse md:p-6 dark:border-gray-700\"\n          >\n            <div className=\"h-2.5 bg-gray-200 rounded-full dark:bg-gray-700 w-32 mb-2.5\"></div>\n            <div className=\"w-48 h-2 mb-10 bg-gray-200 rounded-full dark:bg-gray-700\"></div>\n            <div className=\"flex items-baseline mt-4\">\n              <div className=\"w-full bg-gray-200 rounded-t-lg h-72 dark:bg-gray-300\"></div>\n              <div className=\"w-full h-56 ms-6 bg-gray-200 rounded-t-lg dark:bg-gray-300\"></div>\n              <div className=\"w-full bg-gray-200 rounded-t-lg h-72 ms-6 dark:bg-gray-300\"></div>\n              <div className=\"w-full h-64 ms-6 bg-gray-200 rounded-t-lg dark:bg-gray-300\"></div>\n              <div className=\"w-full bg-gray-200 rounded-t-lg h-80 ms-6 dark:bg-gray-300\"></div>\n              <div className=\"w-full bg-gray-200 rounded-t-lg h-72 ms-6 dark:bg-gray-300\"></div>\n              <div className=\"w-full bg-gray-200 rounded-t-lg h-80 ms-6 dark:bg-gray-300\"></div>\n            </div>\n            <span className=\"sr-only\">Loading...</span>\n          </div>\n        </>\n      )}\n    </>\n  )\n}\n\nexport default Sessionmanage\n"],"names":["Sessionmanage","url","URL","window","location","href","replace","lectureSlug","useState","searchParams","get","session_data","setSessionData","attendances","setAttendances","state","dispatch","ctxDispatch","useContext","Store","accessToken","tableRef","useRef","sessionEnded","setSessionEnded","ws","navigate","useNavigate","StoredTokens","CallAPI","useAPI","useEffect","navigator","geolocation","successCallback","position","errorCallback","error","console","message","i","getCurrentPosition","enableHighAccuracy","maximumAge","headers","axiosInstance","axios","create","lecture_slug","then","responseobj","response","data","active","alert","current","WebSocket","concat","websocket","session_id","marked_attendances","errorMessage","onopen","onclose","onmessage","event","JSON","parse","action","prevArray","onerror","_jsx","_Fragment","children","_jsxs","CRow","CCol","CCard","className","CCardHeader","Date","created_at","toLocaleString","CCardBody","style","margin","padding","lecture","start_time","end_time","subject","subject_name","type","classroom","class_name","xs","DownloadTableExcel","filename","session","day","sheet","currentTableRef","onClick","send","stringify","xmlns","width","height","fill","viewBox","d","align","ref","CTableHead","color","CTableRow","CTableHeaderCell","colSpan","moment","slice","format","CTableBody","map","item","index","CTableDataCell","student","enrollment","profile","name","batches","batch","batch_name","toUpperCase","is_present","fillRule","visibility","e","async","attendance_Slug","preventDefault","confirm","target","checked","disabled","body","attendance_slug","response_obj","div_element","parentElement","innerText","removeChild","svgElement","document","createElementNS","setAttribute","path1","path2","appendChild","prepend","mark_student_attendance","slug","role"],"sourceRoot":""}